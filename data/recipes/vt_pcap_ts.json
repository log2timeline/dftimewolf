{
  "name": "vt_pcap_ts",
  "description": "Fetches pcap for a specific hash and puts it to Timesketch.",
  "short_description": "Fetches pcap for a specific hash  for upload to TS.",
  "modules": [
    {
      "wants": [],
      "name": "VTCollector",
      "args": {
        "hashes": "@hashes",
        "vt_api_key": "@vt_api_key",
        "action": "@action",
        "output_path": "@directory"
      }
    },
    {
      "wants": ["VTCollector"],
      "name": "LocalFilesystemCopy",
      "args": {
        "target_directory": "@directory",
        "compress": false
      }
    },
    {
      "wants": ["LocalFilesystemCopy"],
      "name": "TimesketchExporter",
      "args": {
        "incident_id": "@incident_id",
        "token_password": "@token_password",
        "sketch_id": "@sketch_id",
        "analyzers": null,
        "wait_for_timelines": "@wait_for_timelines"
      },
      "analyzers": ""
    }
  ],
  "args": [
    ["hashes", "Comma-separated list of hashes to process", null],
    ["directory", "Directory in which to export files.", null],
    [
      "--action",
      "String denoting action (download/hash/stat) to take",
      "download"
    ],
    ["--incident_id", "Incident ID (used for Timesketch description)", null],
    ["--sketch_id", "Sketch to which the timeline should be added", null],
    [
      "--token_password",
      "Optional custom password to decrypt Timesketch credential file with",
      ""
    ],
    [
      "--wait_for_timelines",
      "Whether to wait for timelines to finish processing.",
      true
    ],
    ["--vt_api_key", "Virustotal API key", "admin"]
  ]
}
