{
  "name": "vt_evtx_ts",
  "short_description": "Downloads the EVTX from VirusTotal sandbox runs for a specific hash and uploads the corresponding timeline to Timesketch.",
  "description": "Downloads the EVTX file generated by VirusTotal during the sandbox runs for a specific hash, processes the EVTX files with Plaso and uploads the resulting Plaso file to Timesketch.",
  "modules": [
    {
      "wants": [],
      "name": "VTCollector",
      "args": {
        "hashes": "@hashes",
        "vt_api_key": "@vt_api_key",
        "vt_type": "evtx",
        "directory": "@directory"
      }
    },
    {
      "wants": ["VTCollector"],
      "name": "LocalPlasoProcessor",
      "args": {
        "timezone": null
      }
    },
    {
      "wants": ["LocalPlasoProcessor"],
      "name": "TimesketchExporter",
      "args": {
        "incident_id": "@incident_id",
        "token_password": "@token_password",
        "sketch_id": "@sketch_id",
        "analyzers": null,
        "wait_for_timelines": "@wait_for_timelines"
      }
    }
  ],
  "args": [
    ["hashes", "Comma-separated list of hashes to process.", null, {"format": "regex", "comma_separated": true, "regex": "^[0-9a-f]{64}$"}],
    ["directory", "Directory in which to export files.", null],
    ["--vt_api_key", "Virustotal API key", "admin"],
    ["--incident_id", "Incident ID (used for Timesketch description).", null],
    ["--sketch_id", "Timesketch sketch to which the timeline should be added.", null, {"format": "regex", "regex": "^\\d+$"}],
    ["--token_password", "Optional custom password to decrypt Timesketch credential file with", ""],
    ["--wait_for_timelines", "Whether to wait for Timesketch to finish processing all timelines.", true]
  ]
}
